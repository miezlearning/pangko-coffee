<!DOCTYPE html>
<html lang="id">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pangko Coffee ¬∑ Dashboard</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        fontFamily: {
                            sans: ['Manrope', 'system-ui', 'sans-serif']
                        },
                        colors: {
                            matcha: '#74A662',
                            cream: '#FFFDD0',
                            charcoal: '#333333',
                            peach: '#FFE5B4'
                        },
                        boxShadow: {
                            glow: '0 35px 80px -45px rgba(116, 166, 98, 0.65)'
                        }
                    }
                }
            }
        </script>
    </head>
    <body class="min-h-screen bg-cream text-charcoal antialiased">
        <!-- Floating Navbar -->
        <nav id="app-navbar" class="fixed inset-x-0 top-0 z-50 py-4">
            <div class="mx-auto w-full max-w-[1180px] px-5">
                <div id="nav-shell" class="flex items-center justify-between rounded-2xl border border-white/40 bg-white/60 px-6 py-3 backdrop-blur transition-all duration-300">
                    <div class="flex items-center gap-3">
                        <img src="https://media.discordapp.net/attachments/1403748644657828031/1434222820501487791/567458429_17844516144596099_4231043402342710190_n.jpg?ex=69078b96&is=69063a16&hm=501155baf10b69fcf042da9c625e7259b0cbf9e660fce9f608e542b884a46eb2&=&format=webp&width=805&height=805" alt="Pangko Coffee" class="h-14 w-14 rounded-full object-cover border-2 border-white shadow-sm sm:h-16 sm:w-16 md:h-20 md:w-20" />
                        <div class="flex flex-col">
                            <span class="text-sm uppercase tracking-[0.18em] text-matcha">Pangko Coffee</span>
                            <strong class="text-base">Simple coffee, gentle taste.</strong>
                        </div>
                    </div>
                    <div class="hidden items-center gap-5 text-sm font-semibold sm:flex">
                        <a href="/" class="rounded-full px-4 py-2 transition bg-matcha text-white" aria-current="page">Dashboard</a>
                        <a href="/analytics" class="rounded-full px-4 py-2 transition hover:bg-matcha hover:text-white">Statistik</a>
                        <a href="/search" class="rounded-full px-4 py-2 transition hover:bg-matcha hover:text-white">Cari Order</a>
                        <a href="/webhook-tester" class="rounded-full px-4 py-2 transition hover:bg-matcha hover:text-white">Webhook Tester</a>
                    </div>
                    <div class="sm:hidden flex items-center gap-2">
                        <a href="/search" class="rounded-full border border-matcha/40 bg-white/80 px-4 py-2 text-sm font-semibold text-matcha shadow-sm">Cari Order ‚Üí</a>
                        <a href="/analytics" class="rounded-full border border-matcha/40 bg-white/80 px-4 py-2 text-sm font-semibold text-matcha shadow-sm">Analisis ‚Üí</a>
                    </div>
                </div>
            </div>
        </nav>

        <main class="relative mx-auto flex w-full max-w-[1180px] flex-col gap-12 px-5 pt-40 pb-20">
            <!-- Hero / Overview -->
            <section class="relative grid gap-10 lg:grid-cols-[1.05fr_0.95fr]">
                <div class="relative overflow-hidden rounded-3xl bg-white/90 px-10 py-12 shadow-glow">
                    <div class="pointer-events-none absolute -left-16 -top-16 h-64 w-64 rounded-full bg-matcha/25 blur-3xl"></div>
                    <div class="pointer-events-none absolute -right-12 bottom-0 h-56 w-56 rounded-full bg-peach/40 blur-3xl"></div>
                    <div class="relative flex flex-col gap-6">
                        <span class="inline-flex w-max items-center gap-2 rounded-full bg-matcha/15 px-4 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-matcha">Realtime</span>
                        <h1 class="text-4xl font-extrabold leading-tight md:text-5xl">Dashboard Kasir</h1>
                        <p class="max-w-xl text-base text-charcoal/70 md:text-lg">
                            Pantau status pembayaran, dan antrian pesanan. Semangat kerjanya sayang.
                        </p>
                        <div class="flex flex-wrap items-center gap-3">
                            <a href="#stats" class="group inline-flex items-center gap-2 rounded-full bg-matcha px-5 py-3 text-sm font-semibold text-white shadow-lg shadow-matcha/25 transition hover:-translate-y-0.5 hover:shadow-xl">
                                Lihat Snapshot Statistik <span class="transition group-hover:translate-x-1">‚Üí</span>
                            </a>
                            <a href="/webhook-tester" class="inline-flex items-center gap-2 rounded-full border border-matcha/30 bg-white px-5 py-3 text-sm font-semibold text-matcha transition hover:bg-matcha/10">
                                Buka Webhook Tester
                            </a>
                            <a href="/analytics" class="inline-flex items-center gap-2 rounded-full border border-matcha/30 bg-white px-5 py-3 text-sm font-semibold text-matcha transition hover:bg-matcha/10">
                                üìà Buka Analisis
                            </a>
                        </div>
                        <dl class="grid gap-4 pt-4 sm:grid-cols-2">
                            <div class="rounded-2xl border border-matcha/20 bg-cream/80 px-5 py-4">
                                <dt class="text-xs uppercase tracking-[0.28em] text-charcoal/45">Refresh</dt>
                                <dd class="mt-2 flex items-center gap-2 text-lg font-semibold">
                                    <span class="text-matcha">‚ü≥</span> Auto setiap 3 detik
                                </dd>
                            </div>
                            <div class="rounded-2xl border border-peach/30 bg-white/80 px-5 py-4">
                                <dt class="text-xs uppercase tracking-[0.28em] text-charcoal/45">Integrasi</dt>
                                <dd class="mt-2 flex items-center gap-2 text-lg font-semibold">
                                    <span class="text-peach-800">‚ö°</span> Bot & Dashboard sinkron
                                </dd>
                            </div>
                        </dl>
                    </div>
                </div>

                <div class="relative">
                    <div class="absolute inset-0 overflow-hidden rounded-3xl">
                        <img src="https://media.discordapp.net/attachments/1403748644657828031/1434220762654310410/IMG_8190.JPG?ex=690789ac&is=6906382c&hm=0619415beb63ad0dbdd8babbad0a92a2d33cd7d2fd14ca2cd1571bdddc453bd8&=&format=webp&width=1013&height=675" alt="Barista making matcha latte" class="h-full w-full object-cover" />
                        <div class="absolute inset-0 bg-gradient-to-t from-charcoal/80 via-charcoal/35 to-transparent"></div>
                    </div>
                    <div class="relative flex h-full items-end">
                        <div class="w-full rounded-3xl bg-white/85 p-7 text-sm shadow-2xl backdrop-blur">
                            <div class="flex items-start justify-between gap-4">
                                <div>
                                    <h2 class="text-lg font-semibold">Status Gateway</h2>
                                    <p class="mt-1 text-charcoal/60">Dashboard tetap sinkron dengan antrian kasir & bot WhatsApp.</p>
                                </div>
                                <span id="status-badge" class="inline-flex items-center gap-2 rounded-full bg-matcha/15 px-4 py-1 text-xs font-semibold text-matcha">üü¢ ONLINE</span>
                            </div>
                            <div class="mt-6 grid gap-4 md:grid-cols-2">
                                <div class="rounded-2xl border border-matcha/20 bg-matcha/10 p-4">
                                    <p class="text-xs uppercase tracking-[0.22em] text-matcha/80">Sound Notif</p>
                                    <button id="sound-toggle" onclick="toggleSound()" class="mt-3 inline-flex w-full items-center justify-center rounded-xl border border-matcha/60 bg-white px-4 py-2 font-semibold text-matcha transition hover:bg-matcha hover:text-white">
                                        üîî Sound: ON
                                    </button>
                                    <div class="mt-3">
                                        <label for="notif-sound-select" class="block text-xs font-semibold mb-1">Pilih suara notifikasi:</label>
                                        <select id="notif-sound-select" class="w-full rounded-lg border border-matcha/30 px-3 py-2 text-sm font-semibold text-matcha bg-white focus:outline-none focus:border-matcha">
                                        </select>
                                    </div>
                                </div>
                                <div class="rounded-2xl border border-peach/30 bg-peach/25 p-4">
                                    <p class="text-xs uppercase tracking-[0.22em] text-peach-800">Webhook Simulator</p>
                                    <a href="/webhook-tester" class="mt-3 inline-flex w-full items-center justify-between rounded-xl bg-peach px-4 py-2 font-semibold text-charcoal transition hover:opacity-90">
                                        Test Pembayaran <span>‚Üí</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Snapshot Stats -->
            <section class="relative">
                <div class="absolute -top-10 -left-10 hidden h-28 w-28 rounded-full bg-matcha/20 blur-2xl lg:block"></div>
                <div class="relative rounded-3xl border border-white/40 bg-white/90 p-8 shadow-[0_30px_70px_-45px_rgba(51,51,51,0.5)] backdrop-blur">
                    <div class="flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between">
                        <div>
                            <h2 class="text-2xl font-semibold">Snapshot Statistik</h2>
                            <p class="text-sm text-charcoal/60">Semua metrik diperbarui otomatis tanpa perlu refresh manual.</p>
                        </div>
                        <div class="flex flex-wrap items-center gap-2 text-xs font-semibold text-charcoal/60">
                            <span class="inline-flex items-center gap-2 rounded-full bg-matcha/15 px-3 py-1">
                                <span class="text-matcha">‚óè</span> Realtime Watcher
                            </span>
                            <span class="inline-flex items-center gap-2 rounded-full bg-peach/25 px-3 py-1">
                                <span class="text-peach-800">üöÄ</span> Sinkron Order Manager
                            </span>
                            <a href="/analytics" class="inline-flex items-center gap-2 rounded-full border border-matcha/35 bg-white px-4 py-2 text-sm font-semibold text-matcha transition hover:bg-matcha hover:text-white">
                                üìà Statistik
                            </a>
                            <a href="/api/export/finance" class="ml-auto inline-flex items-center gap-2 rounded-full border border-peach/40 bg-white px-4 py-2 text-sm font-semibold text-peach-800 transition hover:bg-peach hover:text-charcoal">
                                üì§ Export Excel
                            </a>
                        </div>
                    </div>
                    <div id="stats" class="mt-8 grid gap-4 sm:grid-cols-2 xl:grid-cols-3">
                        <article class="group rounded-2xl border border-matcha/20 bg-cream/70 p-6 shadow-sm transition hover:-translate-y-1 hover:shadow-lg">
                            <p class="text-sm text-charcoal/55">‚è≥ Pending Payments</p>
                            <span id="pending-count" class="mt-4 block text-4xl font-bold text-charcoal">-</span>
                        </article>
                        <article class="group rounded-2xl border border-matcha/10 bg-white p-6 shadow-sm transition hover:-translate-y-1 hover:shadow-lg">
                            <p class="text-sm text-charcoal/55">üì¶ Orders Hari Ini</p>
                            <span id="today-orders" class="mt-4 block text-4xl font-bold text-charcoal">-</span>
                        </article>
                        <article class="group rounded-2xl border border-peach/25 bg-white p-6 shadow-sm transition hover:-translate-y-1 hover:shadow-lg">
                            <p class="text-sm text-charcoal/55">üí∞ Revenue Hari Ini</p>
                            <span id="today-revenue" class="mt-4 block text-4xl font-bold text-charcoal">-</span>
                        </article>
                    </div>
                </div>
            </section>

            <!-- Data Panels -->
            <section class="grid gap-10 lg:grid-cols-[1.15fr_0.85fr]">
                <article class="rounded-3xl border border-white/45 bg-white/90 p-7 shadow-[0_25px_60px_-45px_rgba(116,166,98,0.55)] backdrop-blur">
                    <div class="flex flex-col gap-4 border-b border-white/60 pb-5 sm:flex-row sm:items-center sm:justify-between">
                        <div>
                            <h3 class="text-xl font-semibold">‚è≥ Pending Payments</h3>
                            <p class="text-sm text-charcoal/60">Konfirmasi pembayaran langsung dari layar ini.</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="loadPayments()" class="inline-flex items-center gap-2 rounded-full border border-matcha/30 px-4 py-2 text-sm font-semibold text-matcha transition hover:bg-matcha hover:text-white">
                                üîÑ Refresh Data
                            </button>
                        </div>
                    </div>
                    <div id="payments-list" class="mt-6 space-y-4"></div>
                </article>

                <article class="rounded-3xl border border-white/45 bg-white/90 p-7 shadow-[0_25px_60px_-45px_rgba(255,229,180,0.6)] backdrop-blur">
                    <div class="flex flex-col gap-4 border-b border-white/60 pb-5 sm:flex-row sm:items-center sm:justify-between">
                        <div>
                            <h3 class="text-xl font-semibold">üë®‚Äçüç≥ Processing Orders</h3>
                            <p class="text-sm text-charcoal/60">Monitor progres barista dan tandai pesanan siap.</p>
                        </div>
                        <button onclick="loadProcessingOrders()" class="inline-flex items-center gap-2 rounded-full border border-peach/40 px-4 py-2 text-sm font-semibold text-peach-800 transition hover:bg-peach hover:text-charcoal">
                            üîÑ Refresh Queue
                        </button>
                    </div>
                    <div id="processing-list" class="mt-6 space-y-4"></div>
                </article>
            </section>

            <!-- Cash Queue Panel -->
            <section>
                <article class="rounded-3xl border border-white/45 bg-white/90 p-7 shadow-[0_25px_60px_-45px_rgba(51,51,51,0.35)] backdrop-blur">
                    <div class="flex flex-col gap-4 border-b border-white/60 pb-5 sm:flex-row sm:items-center sm:justify-between">
                        <div>
                            <h3 class="text-xl font-semibold">üíµ Menunggu Konfirmasi Tunai</h3>
                            <p class="text-sm text-charcoal/60">Terima pembayaran tunai untuk mulai proses barista.</p>
                        </div>
                        <button onclick="loadPendingCash()" class="inline-flex items-center gap-2 rounded-full border border-charcoal/15 px-4 py-2 text-sm font-semibold text-charcoal/80 transition hover:bg-charcoal/5">
                            üîÑ Refresh Tunai
                        </button>
                    </div>
                    <div id="pending-cash-list" class="mt-6 space-y-4"></div>
                </article>
            </section>

            <!-- Cancelled Cash (Reopen) -->
            <section>
                <article class="rounded-3xl border border-white/45 bg-white/90 p-7">
                    <div class="flex flex-col gap-4 border-b border-white/60 pb-5 sm:flex-row sm:items-center sm:justify-between">
                        <div>
                            <h3 class="text-xl font-semibold">‚è∏Ô∏è Dibatalkan (Tunai) - Bisa Dibuka Kembali</h3>
                            <p class="text-sm text-charcoal/60">Hanya yang masih dalam window buka kembali.</p>
                        </div>
                        <button onclick="loadCancelledCash()" class="inline-flex items-center gap-2 rounded-full border border-rose-300 px-4 py-2 text-sm font-semibold text-rose-700 transition hover:bg-rose-50">
                            üîÑ Refresh Dibatalkan
                        </button>
                    </div>
                    <div id="cancelled-cash-list" class="mt-6 space-y-4"></div>
                </article>
            </section>
        </main>

        <!-- Toast Notification -->
        <div id="notification" class="fixed right-6 top-6 hidden w-full max-w-xs -translate-y-2 rounded-3xl border border-matcha/20 bg-white/95 p-5 text-sm opacity-0 shadow-2xl shadow-matcha/20 transition-all duration-300 backdrop-blur">
            <p class="font-semibold">üîî Pembayaran Baru!</p>
            <p id="notification-text" class="mt-1 text-charcoal/70"></p>
        </div>

        <!-- Reject Modal -->
        <div id="reject-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-charcoal/40 p-4 opacity-0 transition-opacity duration-200">
            <div class="w-full max-w-md rounded-3xl border border-white/50 bg-white/95 p-6 shadow-2xl">
                <div class="mb-4">
                    <h3 class="text-lg font-semibold">‚ùå Tolak Pembayaran</h3>
                    <p class="mt-1 text-sm text-charcoal/65">Berikan alasan penolakan. Customer akan menerima pesan ini.</p>
                </div>
                <label for="reject-reason" class="mb-2 block text-xs font-semibold uppercase tracking-[0.25em] text-charcoal/60">Alasan</label>
                <textarea id="reject-reason" rows="4" class="w-full rounded-2xl border border-charcoal/10 bg-white/90 p-3 text-sm outline-none ring-matcha/30 focus:ring-2" placeholder="Contoh: Bukti transfer tidak sesuai / kode nominal salah"></textarea>
                <div class="mt-5 grid grid-cols-2 gap-3">
                    <button id="reject-cancel" class="rounded-2xl border border-charcoal/15 bg-white px-4 py-2 text-sm font-semibold text-charcoal/70 transition hover:bg-charcoal/5">Batal</button>
                    <button id="reject-submit" class="rounded-2xl bg-rose-500 px-4 py-2 text-sm font-semibold text-white transition hover:opacity-90">Tolak Pembayaran</button>
                </div>
            </div>
        </div>

        <script>
            const shell = document.getElementById('nav-shell');
            function handleNavShadow() {
                if (window.scrollY > 6) {
                    shell.classList.add('shadow-[0_25px_60px_-35px_rgba(51,51,51,0.25)]','bg-white/85');
                } else {
                    shell.classList.remove('shadow-[0_25px_60px_-35px_rgba(51,51,51,0.25)]','bg-white/85');
                }
            }
            window.addEventListener('scroll', handleNavShadow);
            handleNavShadow();
        </script>

        <script src="/js/dashboard.js"></script>
    </body>
</html>
