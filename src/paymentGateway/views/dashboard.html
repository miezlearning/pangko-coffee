<!DOCTYPE html>
<html lang="id">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pangko Coffee ¬∑ Dashboard</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Twemoji to ensure emojis render consistently across platforms -->
    <script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js" crossorigin="anonymous"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        fontFamily: {
                            // Add robust emoji fallbacks so emojis render on Windows/macOS/Linux
                            sans: ['Manrope', 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', 'system-ui', 'sans-serif']
                        },
                        colors: {
                            matcha: '#74A662',
                            cream: '#FFFDD0',
                            charcoal: '#333333',
                            peach: '#FFE5B4'
                        },
                        boxShadow: {
                            glow: '0 35px 80px -45px rgba(116, 166, 98, 0.65)'
                        }
                    }
                }
            }
        </script>
        <style>
            /* Ensure emoji fonts are used where available (especially on Windows) */
            body { font-family: Manrope, "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji", system-ui, sans-serif; }
            /* Normalize emoji image sizing when Twemoji replaces glyphs */
            img.emoji { height: 1em; width: 1em; margin: 0 .05em; vertical-align: -0.15em; }
            .tab-content {
                animation: fadeIn 0.3s ease-in-out;
            }
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
            }
        </style>
  </head>
  <body class="min-h-screen bg-cream text-charcoal antialiased" data-page="dashboard">
    <!-- Navbar will be injected here by navbar.js -->
    <div id="navbar-container"></div>        <main class="relative mx-auto flex w-full max-w-[1180px] flex-col gap-12 px-5 pt-40 pb-20">
            <!-- Hero / Overview -->
            <section class="relative grid gap-10 lg:grid-cols-[1.05fr_0.95fr]">
                <div class="relative overflow-hidden rounded-3xl bg-white/90 px-10 py-12 shadow-glow">
                    <div class="pointer-events-none absolute -left-16 -top-16 h-64 w-64 rounded-full bg-matcha/25 blur-3xl"></div>
                    <div class="pointer-events-none absolute -right-12 bottom-0 h-56 w-56 rounded-full bg-peach/40 blur-3xl"></div>
                    <div class="relative flex flex-col gap-6">
                        <span class="inline-flex w-max items-center gap-2 rounded-full bg-matcha/15 px-4 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-matcha">Realtime</span>
                        <h1 class="text-4xl font-extrabold leading-tight md:text-5xl">Dashboard Kasir</h1>
                        <p class="max-w-xl text-base text-charcoal/70 md:text-lg">
                            Pantau status pembayaran, dan antrian pesanan. Semangat kerjanya sayang.
                        </p>
                        <div class="flex flex-wrap items-center gap-3">
                            <a href="#stats" class="group inline-flex items-center gap-2 rounded-full bg-matcha px-5 py-3 text-sm font-semibold text-white shadow-lg shadow-matcha/25 transition hover:-translate-y-0.5 hover:shadow-xl">
                                Lihat Snapshot Statistik <span class="transition group-hover:translate-x-1">‚Üí</span>
                            </a>
                            <a href="/webhook-tester" class="inline-flex items-center gap-2 rounded-full border border-matcha/30 bg-white px-5 py-3 text-sm font-semibold text-matcha transition hover:bg-matcha/10">
                                Buka Webhook Tester
                            </a>
                            <a href="/analytics" class="inline-flex items-center gap-2 rounded-full border border-matcha/30 bg-white px-5 py-3 text-sm font-semibold text-matcha transition hover:bg-matcha/10">
                                üìà Buka Analisis
                            </a>
                            <a href="/import" class="inline-flex items-center gap-2 rounded-full border border-charcoal/20 bg-white px-5 py-3 text-sm font-semibold text-charcoal transition hover:bg-charcoal/5">
                                üì• Import Data
                            </a>
                            <!-- Big Cashier CTA -->
                            <a href="/cashier" class="group inline-flex items-center gap-3 rounded-2xl bg-peach px-6 py-4 text-base font-extrabold text-charcoal shadow-md shadow-peach/40 transition hover:shadow-lg hover:-translate-y-0.5">
                                üßæ Buka Kasir / Buat Pesanan <span class="transition group-hover:translate-x-1">‚Üí</span>
                            </a>
                        </div>
                        <dl class="grid gap-4 pt-4 sm:grid-cols-2">
                            <div class="rounded-2xl border border-matcha/20 bg-cream/80 px-5 py-4">
                                <dt class="text-xs uppercase tracking-[0.28em] text-charcoal/45">Refresh</dt>
                                <dd class="mt-2 flex items-center gap-2 text-lg font-semibold">
                                    <span class="text-matcha">‚ü≥</span> Auto setiap 3 detik
                                </dd>
                            </div>
                            <div class="rounded-2xl border border-peach/30 bg-white/80 px-5 py-4">
                                <dt class="text-xs uppercase tracking-[0.28em] text-charcoal/45">Integrasi</dt>
                                <dd class="mt-2 flex items-center gap-2 text-lg font-semibold">
                                    <span class="text-peach-800">‚ö°</span> Bot & Dashboard sinkron
                                </dd>
                            </div>
                        </dl>
                    </div>
                </div>

                <div class="relative">
                    <div class="absolute inset-0 overflow-hidden rounded-3xl">
                        <img src="https://media.discordapp.net/attachments/1403748644657828031/1434220762654310410/IMG_8190.JPG?ex=690789ac&is=6906382c&hm=0619415beb63ad0dbdd8babbad0a92a2d33cd7d2fd14ca2cd1571bdddc453bd8&=&format=webp&width=1013&height=675" alt="Barista making matcha latte" class="h-full w-full object-cover" />
                        <div class="absolute inset-0 bg-gradient-to-t from-charcoal/80 via-charcoal/35 to-transparent"></div>
                    </div>
                    <div class="relative flex h-full items-end">
                        <div class="w-full rounded-3xl bg-white/85 p-7 text-sm shadow-2xl backdrop-blur">
                            <div class="flex items-start justify-between gap-4">
                                <div>
                                    <h2 class="text-lg font-semibold">Status Gateway</h2>
                                    <p class="mt-1 text-charcoal/60">Dashboard tetap sinkron dengan antrian kasir & bot WhatsApp.</p>
                                </div>
                                <span id="status-badge" class="inline-flex items-center gap-2 rounded-full bg-matcha/15 px-4 py-1 text-xs font-semibold text-matcha">
                                    <svg class="h-3 w-3 text-matcha" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                        <circle cx="8" cy="8" r="8" />
                                    </svg>
                                    <span>ONLINE</span>
                                </span>
                            </div>
                            <div class="mt-6 grid gap-4 md:grid-cols-2">
                                <div class="rounded-2xl border border-matcha/20 bg-matcha/10 p-4">
                                    <p class="text-xs uppercase tracking-[0.22em] text-matcha/80">Sound Notif</p>
                                    <button id="sound-toggle" onclick="toggleSound()" class="mt-3 inline-flex w-full items-center justify-center rounded-xl border border-matcha/60 bg-white px-4 py-2 font-semibold text-matcha transition hover:bg-matcha hover:text-white">
                                        üîî Sound: ON
                                    </button>
                                    <div class="mt-3">
                                        <label for="notif-sound-select" class="block text-xs font-semibold mb-1">Pilih suara notifikasi:</label>
                                        <select id="notif-sound-select" class="w-full rounded-lg border border-matcha/30 px-3 py-2 text-sm font-semibold text-matcha bg-white focus:outline-none focus:border-matcha">
                                        </select>
                                    </div>
                                </div>
                                <div class="rounded-2xl border border-peach/30 bg-peach/25 p-4">
                                    <p class="text-xs uppercase tracking-[0.22em] text-peach-800">Webhook Simulator</p>
                                    <a href="/webhook-tester" class="mt-3 inline-flex w-full items-center justify-between rounded-xl bg-peach px-4 py-2 font-semibold text-charcoal transition hover:opacity-90">
                                        Test Pembayaran <span>‚Üí</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Quick Stats Bar -->
            <section class="relative">
                <div class="relative rounded-3xl border border-white/40 bg-white/90 p-6 shadow-[0_30px_70px_-45px_rgba(51,51,51,0.5)] backdrop-blur">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <div class="flex items-center gap-3">
                            <div class="rounded-full bg-matcha/15 p-3">
                                <svg class="h-6 w-6 text-matcha" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                </svg>
                            </div>
                            <div>
                                <h2 class="text-lg font-bold text-charcoal">Ringkasan Hari Ini</h2>
                                <p class="text-xs text-charcoal/60">Update otomatis setiap 3 detik</p>
                            </div>
                        </div>
                        <div class="flex flex-wrap items-center gap-3">
                            <div class="rounded-2xl border border-matcha/20 bg-cream/70 px-5 py-3">
                                <p class="text-xs text-charcoal/55">üì¶ Pesanan</p>
                                <span id="today-orders" class="mt-1 block text-2xl font-bold text-charcoal">-</span>
                            </div>
                            <div class="rounded-2xl border border-peach/25 bg-white px-5 py-3">
                                <p class="text-xs text-charcoal/55">
                                    <svg class="h-4 w-4 text-peach-800 inline" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                                        <path d="M12 8c-3.866 0-7 1.343-7 3s3.134 3 7 3 7-1.343 7-3-3.134-3-7-3z" />
                                        <path d="M12 8v8" />
                                        <path d="M5 12v4" />
                                        <path d="M19 12v4" />
                                    </svg>
                                    Revenue
                                </p>
                                <span id="today-revenue" class="mt-1 block text-2xl font-bold text-charcoal">-</span>
                            </div>
                            <a href="/analytics" class="inline-flex items-center gap-2 rounded-full border border-matcha/35 bg-white px-4 py-2.5 text-sm font-semibold text-matcha transition hover:bg-matcha hover:text-white">
                                <svg class="h-4 w-4 text-matcha" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                                    <path d="M3 3v18h18" />
                                    <path d="M9 17V9" />
                                    <path d="M13 17V5" />
                                    <path d="M17 17v-7" />
                                Export Excel
                            </a>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab Navigation -->
            <section class="relative">
                <div class="relative rounded-3xl border border-white/40 bg-white/95 shadow-lg backdrop-blur overflow-hidden">
                    <!-- Tab Buttons -->
                    <div class="flex overflow-x-auto border-b border-charcoal/10 bg-gradient-to-r from-cream/30 to-peach/20">
                        <button onclick="switchTab('qris')" id="tab-qris" class="tab-btn flex-1 min-w-[160px] px-6 py-5 text-sm font-semibold transition border-b-4 border-transparent hover:bg-white/60">
                            <div class="flex flex-col items-center gap-2">
                                <!-- Bell icon (inline SVG) -->
                                <svg class="h-6 w-6 text-amber-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                                    <path d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 10-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5" />
                                    <path d="M13.73 21a2 2 0 01-3.46 0" />
                                </svg>
                                <span>Pending QRIS</span>
                                <span id="count-qris" class="rounded-full bg-red-500 px-3 py-0.5 text-xs text-white font-bold">0</span>
                            </div>
                        </button>
                        <button onclick="switchTab('cash')" id="tab-cash" class="tab-btn flex-1 min-w-[160px] px-6 py-5 text-sm font-semibold transition border-b-4 border-transparent hover:bg-white/60">
                            <div class="flex flex-col items-center gap-2">
                                <!-- Cash / wallet icon -->
                                <svg class="h-6 w-6 text-orange-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                                    <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                                    <path d="M1 10h22" />
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                                <span>Pending Tunai</span>
                                <span id="count-cash" class="rounded-full bg-orange-500 px-3 py-0.5 text-xs text-white font-bold">0</span>
                            </div>
                        </button>
                        <button onclick="switchTab('processing')" id="tab-processing" class="tab-btn flex-1 min-w-[160px] px-6 py-5 text-sm font-semibold transition border-b-4 border-transparent hover:bg-white/60">
                            <div class="flex flex-col items-center gap-2">
                                <!-- Coffee cup icon for processing -->
                                <svg class="h-6 w-6 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                                    <path d="M18 8v2a4 4 0 01-4 4H6a4 4 0 01-4-4V8"></path>
                                    <path d="M3 3h18v2a4 4 0 01-4 4H7a4 4 0 01-4-4V3z"></path>
                                    <path d="M16 18a2 2 0 01-2 2H6a2 2 0 01-2-2"></path>
                                </svg>
                                <span>Diproses</span>
                                <span id="count-processing" class="rounded-full bg-blue-500 px-3 py-0.5 text-xs text-white font-bold">0</span>
                            </div>
                        </button>
                        <button onclick="switchTab('ready')" id="tab-ready" class="tab-btn flex-1 min-w-[160px] px-6 py-5 text-sm font-semibold transition border-b-4 border-transparent hover:bg-white/60">
                            <div class="flex flex-col items-center gap-2">
                                <!-- Check circle -->
                                <svg class="h-6 w-6 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                                    <path d="M9 12l2 2 4-4"></path>
                                    <circle cx="12" cy="12" r="9"></circle>
                                </svg>
                                <span>Siap Diambil</span>
                                <span id="count-ready" class="rounded-full bg-green-500 px-3 py-0.5 text-xs text-white font-bold">0</span>
                            </div>
                        </button>
                        <button onclick="switchTab('cancelled')" id="tab-cancelled" class="tab-btn flex-1 min-w-[160px] px-6 py-5 text-sm font-semibold transition border-b-4 border-transparent hover:bg-white/60">
                            <div class="flex flex-col items-center gap-2">
                                <!-- Pause icon -->
                                <svg class="h-6 w-6 text-gray-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                                    <rect x="6" y="5" width="4" height="14"></rect>
                                    <rect x="14" y="5" width="4" height="14"></rect>
                                </svg>
                                <span>Dibatalkan</span>
                                <span id="count-cancelled" class="rounded-full bg-gray-500 px-3 py-0.5 text-xs text-white font-bold">0</span>
                            </div>
                        </button>
                    </div>

                    <!-- Tab Content -->
                    <div class="p-8">
                        <!-- QRIS Tab -->
                        <div id="content-qris" class="tab-content hidden">
                            <div class="flex flex-col gap-4 border-b border-charcoal/10 pb-5 mb-6 sm:flex-row sm:items-center sm:justify-between">
                                <div>
                                    <h3 class="text-2xl font-bold flex items-center gap-3">
                                        <span class="rounded-full bg-red-500/15 p-2">üîî</span>
                                        Pending Payments (QRIS)
                                    </h3>
                                    <p class="text-sm text-charcoal/60 mt-1">Konfirmasi pembayaran QRIS langsung dari sini</p>
                                </div>
                                <button onclick="loadPayments()" class="inline-flex items-center gap-2 rounded-full border border-matcha/30 bg-matcha px-5 py-2.5 text-sm font-semibold text-white transition hover:bg-matcha/90 shadow-md">
                                    üîÑ Refresh
                                </button>
                            </div>
                            <div id="payments-list" class="space-y-4"></div>
                        </div>

                        <!-- Cash Tab -->
                        <div id="content-cash" class="tab-content hidden">
                            <div class="flex flex-col gap-4 border-b border-charcoal/10 pb-5 mb-6 sm:flex-row sm:items-center sm:justify-between">
                                <div>
                                    <h3 class="text-2xl font-bold flex items-center gap-3">
                                        <span class="rounded-full bg-orange-500/15 p-2">üíµ</span>
                                        Menunggu Konfirmasi Tunai
                                    </h3>
                                    <p class="text-sm text-charcoal/60 mt-1">Terima pembayaran tunai untuk mulai proses barista</p>
                                </div>
                                <button onclick="loadPendingCash()" class="inline-flex items-center gap-2 rounded-full border border-orange-500/30 bg-orange-500 px-5 py-2.5 text-sm font-semibold text-white transition hover:bg-orange-500/90 shadow-md">
                                    üîÑ Refresh
                                </button>
                            </div>
                            <div id="pending-cash-list" class="space-y-4"></div>
                        </div>

                        <!-- Processing Tab -->
                        <div id="content-processing" class="tab-content hidden">
                            <div class="flex flex-col gap-4 border-b border-charcoal/10 pb-5 mb-6 sm:flex-row sm:items-center sm:justify-between">
                                <div>
                                    <h3 class="text-2xl font-bold flex items-center gap-3">
                                        <span class="rounded-full bg-blue-500/15 p-2">üë®‚Äçüç≥</span>
                                        Sedang Diproses
                                    </h3>
                                    <p class="text-sm text-charcoal/60 mt-1">Monitor progres barista dan tandai pesanan siap</p>
                                </div>
                                <button onclick="loadProcessingOrders()" class="inline-flex items-center gap-2 rounded-full border border-blue-500/30 bg-blue-500 px-5 py-2.5 text-sm font-semibold text-white transition hover:bg-blue-500/90 shadow-md">
                                    üîÑ Refresh
                                </button>
                            </div>
                            <div id="processing-list" class="space-y-4"></div>
                        </div>

                        <!-- Ready Tab -->
                        <div id="content-ready" class="tab-content hidden">
                            <div class="flex flex-col gap-4 border-b border-charcoal/10 pb-5 mb-6 sm:flex-row sm:items-center sm:justify-between">
                                <div>
                                    <h3 class="text-2xl font-bold flex items-center gap-3">
                                        <span class="rounded-full bg-green-500/15 p-2 ring-4 ring-green-500/20 animate-pulse">‚úÖ</span>
                                        Siap Diambil
                                    </h3>
                                    <p class="text-sm text-charcoal/60 mt-1">Tandai selesai jika customer sudah mengambil pesanan</p>
                                </div>
                                <button onclick="loadReadyOrders()" class="inline-flex items-center gap-2 rounded-full border border-green-500/30 bg-green-500 px-5 py-2.5 text-sm font-semibold text-white transition hover:bg-green-500/90 shadow-md">
                                    üîÑ Refresh
                                </button>
                            </div>
                            <div id="ready-list" class="space-y-4"></div>
                        </div>

                        <!-- Cancelled Tab -->
                        <div id="content-cancelled" class="tab-content hidden">
                            <div class="flex flex-col gap-4 border-b border-charcoal/10 pb-5 mb-6 sm:flex-row sm:items-center sm:justify-between">
                                <div>
                                    <h3 class="text-2xl font-bold flex items-center gap-3">
                                        <span class="rounded-full bg-gray-500/15 p-2">‚è∏Ô∏è</span>
                                        Dibatalkan (Tunai) - Bisa Dibuka Kembali
                                    </h3>
                                    <p class="text-sm text-charcoal/60 mt-1">Hanya yang masih dalam window buka kembali</p>
                                </div>
                                <button onclick="loadCancelledCash()" class="inline-flex items-center gap-2 rounded-full border border-gray-500/30 bg-gray-500 px-5 py-2.5 text-sm font-semibold text-white transition hover:bg-gray-500/90 shadow-md">
                                    üîÑ Refresh
                                </button>
                            </div>
                            <div id="cancelled-cash-list" class="space-y-4"></div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Toast Notification -->
        <div id="notification" class="fixed right-6 top-6 hidden w-full max-w-xs -translate-y-2 rounded-3xl border border-matcha/20 bg-white/95 p-5 text-sm opacity-0 shadow-2xl shadow-matcha/20 transition-all duration-300 backdrop-blur">
            <p class="font-semibold inline-flex items-center gap-2">
                <svg class="h-5 w-5 text-matcha" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <path d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 10-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5" />
                    <path d="M13.73 21a2 2 0 01-3.46 0" />
                </svg>
                Pembayaran Baru!
            </p>
            <p id="notification-text" class="mt-1 text-charcoal/70"></p>
        </div>

        <!-- Reject Modal -->
        <div id="reject-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-charcoal/40 p-4 opacity-0 transition-opacity duration-200">
            <div class="w-full max-w-md rounded-3xl border border-white/50 bg-white/95 p-6 shadow-2xl">
                <div class="mb-4">
                    <h3 class="text-lg font-semibold">‚ùå Tolak Pembayaran</h3>
                    <p class="mt-1 text-sm text-charcoal/65">Berikan alasan penolakan. Customer akan menerima pesan ini.</p>
                </div>
                <label for="reject-reason" class="mb-2 block text-xs font-semibold uppercase tracking-[0.25em] text-charcoal/60">Alasan</label>
                <textarea id="reject-reason" rows="4" class="w-full rounded-2xl border border-charcoal/10 bg-white/90 p-3 text-sm outline-none ring-matcha/30 focus:ring-2" placeholder="Contoh: Bukti transfer tidak sesuai / kode nominal salah"></textarea>
                <div class="mt-5 grid grid-cols-2 gap-3">
                    <button id="reject-cancel" class="rounded-2xl border border-charcoal/15 bg-white px-4 py-2 text-sm font-semibold text-charcoal/70 transition hover:bg-charcoal/5">Batal</button>
                    <button id="reject-submit" class="rounded-2xl bg-rose-500 px-4 py-2 text-sm font-semibold text-white transition hover:opacity-90">Tolak Pembayaran</button>
                </div>
            </div>
        </div>

        <script src="/js/navbar.js"></script>
        <script src="/js/dashboard.js"></script>
        <script>
            // Parse emojis using Twemoji initially and whenever DOM updates (lists refresh every 3s)
            document.addEventListener('DOMContentLoaded', function () {
                if (window.twemoji) {
                    const parseAll = () => {
                        try { twemoji.parse(document.body, { folder: 'svg', ext: '.svg' }); } catch (_) {}
                    };
                    parseAll();
                    const obs = new MutationObserver(() => parseAll());
                    obs.observe(document.body, { childList: true, subtree: true });
                }
            });
        </script>
    </body>
</html>
